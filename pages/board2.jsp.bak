<%@ page import = "java.sql.*, java.util.*"%>
<%@page contentType="text/html" pageEncoding="utf-8"%>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Violet Cafe</title>
    <link rel="icon" href="../image/icon.ico">
    <link rel="stylesheet" href="../css/board.css"> <!--é€£çµCSS-->
</head>
<html>
<body>
    <header>
        <div class="logo"> <!--LOGO-->
            <a href="index2.jsp"><img src="../image/logo.png" style="width: 100px; height: 100px;"></a>
        </div>
        <nav>
            <a href="index2.jsp">é¦–é </a>
            <a href="coffee2.jsp">å•†å“é é¢</a>
            <a href="board2.jsp">ç•™è¨€æ¿</a>
            <a href="aboutus2.html">é—œæ–¼æˆ‘å€‘</a>
            <a href="logout.jsp">ç™»å‡ºæœƒå“¡</a>
            <a href="members.jsp">ä¿®æ”¹æœƒå“¡è³‡æ–™</a>
            <a href="cart2.jsp">ğŸ›’è³¼ç‰©è»Š</a>
        </nav>
    </header>   

    <div class="bgset">
        <main>
            <br><br><h1>ç•™è¨€æ¿</h1>
            <div class="container">
                <h2>ä½ å€‘çš„æ¯ä¸€æ¢æ„è¦‹ï¼Œéƒ½å¯ä»¥è®“æˆ‘å€‘è®Šå¾—æ›´å¥½!</h2>
                <h3>-Violet Cafe-</h3>
            </div>
            <div class="container1">
                <h2>åœ¨æ­¤è§€çœ‹å…¶ä»–äººçš„ç•™è¨€</h2>
				<%
					String pro_id = request.getParameter("gopro");
					try {
					//Step 1: è¼‰å…¥è³‡æ–™åº«é©…å‹•ç¨‹å¼ 
						Class.forName("com.mysql.jdbc.Driver");
						try {
					//Step 2: å»ºç«‹é€£ç·š 	
							String url="jdbc:mysql://localhost/?serverTimezone=UTC";
							String sql="";
							Connection con=DriverManager.getConnection(url,"root","1234");
							if(con.isClosed())
							   out.println("é€£ç·šå»ºç«‹å¤±æ•—");
							else {
					//Step 3: é¸æ“‡è³‡æ–™åº«   
								sql="USE `coffee`";
								con.createStatement().execute(sql);
					//Step 4: åŸ·è¡Œ SQL æŒ‡ä»¤, è‹¥è¦æ“ä½œè¨˜éŒ„é›†, éœ€ä½¿ç”¨executeQuery, æ‰èƒ½å‚³å›ResultSet
								String comm = request.getParameter("gopro");
								sql="SELECT * FROM `board` WHERE `board_id` = '"+pro_id+"'"; //ç®—å‡ºå…±å¹¾ç­†ç•™è¨€
								ResultSet rs=con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY).executeQuery(sql);
								rs.last();
								int total_content = rs.getRow();
					//Step 5: é¡¯ç¤ºçµæœ

								sql = "SELECT * FROM `board` WHERE `customer_id` = '"+pro_id+"' ORDER BY `board_id` DESC";
								rs = con.createStatement().executeQuery(sql);
								while(rs.next()){
										out.print("<div class='board'>");
										out.print("<div class='msg'>");
										out.print("<h4 style='text-align:left;'>å§“å:"+rs.getString(3)+"</h4>");
										out.print("<h4 style='text-align:left;'>è³¼è²·å•†å“:"+rs.getString(4)+"</h4>");
										out.print("<h4 style='text-align:left;'>è©•åƒ¹æ˜Ÿç´š:"+rs.getString(5)+"â˜…</h4>");
										out.print("<h4 style='text-align:left;'>è©•åƒ¹å…§å®¹:"+rs.getString(6)+"</h4>");
										out.print("<h4 style='text-align:left;'>æ—¥æœŸ:"+rs.getString(7)+"</h4>");
										out.print("</div>");
										out.print("</div>");
									}
					//Step 6: é—œé–‰é€£ç·š
							  con.close();
						  }
						}
						catch (SQLException sExec) {
							   out.println("SQLéŒ¯èª¤"+sExec.toString());
							   
						}
					}
					catch (ClassNotFoundException err) {
						  out.println("classéŒ¯èª¤"+err.toString());
					}
				%>

            <div class="container2">
                <div class="add">
					
                    <h2>æˆ–åœ¨æ­¤ç•™ä¸‹å›é¥‹å§!</h2>
                    <form action="board_add.jsp" method="post">
                        ç•™è¨€è€…ï¼š<input type="text" name="author"><br>
                        è³¼è²·çš„å•†å“ï¼š<input type="text" name="product"><br>
                        <div class="STAR">
                            è©•åƒ¹æ˜Ÿç´šï¼š
                            <input type="radio" name="star" id="star1" value="5">
                            <label for="star1">5â˜…</label>
                            <input type="radio" name="star" id="star2" value="4">
                            <label for="star2">4â˜…</label>
                            <input type="radio" name="star" id="star3" value="3">
                            <label for="star3">3â˜…</label>
                            <input type="radio" name="star" id="star4" value="2">
                            <label for="star4">2â˜…</label>
                            <input type="radio" name="star" id="star5" value="1">
                            <label for="star5">1â˜…</label>
                        </div>
                        æƒ³åˆ†äº«çš„å…§å®¹ï¼š<br><textarea row="2" cols="30" name="content" wrap="soft"></textarea><br>
						<input type="hidden" name="com" value="<%=pro_id%>">
                        <button type="submit">é€å‡ºç•™è¨€</button>
                    </form>
                </div>
            </div>
        </main>
        <div class="fix"></div>
        <footer>
            <p class="pagetop"><a href="#top">â–²å›TOP</a></p> <!--TOPå‚³é€é–€-->
            <p class="copyright">ç€è¦½äººæ•¸ï¼š<%@include file="counter.jsp"%><br> Copyright Â© 2023ã€‚æœ¬ç¶²ç«™åƒ…ç‚ºä½œæ¥­ä¹‹ç”¨ï¼Œå¦‚æœ‰ä¾µæ¬Šæ•¬è«‹å‘ŠçŸ¥ã€‚</p>
        </footer>
    </div>
</body>
</html>